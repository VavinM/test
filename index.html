<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–û—Ü–µ–Ω–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; background: #f9f9f9; }
    h1 { text-align: center; }
    input[type="file"] { margin: 20px 0; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; background: #fff; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #eee; }
  </style>
</head>
<body>
<h1>–ê–Ω–∞–ª–∏–∑ –∞–Ω–∫–µ—Ç—ã: –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª</h1>
<p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV-—Ñ–∞–π–ª —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –Ω–∞ 31 –≤–æ–ø—Ä–æ—Å.</p>
<input type="file" accept=".csv" onchange="processFile(event)">
<div id="result"></div>

<script>
const weights = {
  1:8, 2:7, 3:6, 4:7, 5:5, 6:8, 7:7, 8:6, 9:5, 10:6,
  11:5, 12:8, 13:7, 14:6, 15:7, 16:5, 17:4, 18:7, 19:5, 20:4, 21:7, 22:5,
  23:6, 24:5, 25:7, 26:8, 27:7, 28:6, 29:7, 30:6, 31:8
};

const mapping = {
  // –ë–∞–ª–ª 1
  '–°–æ–≤—Å–µ–º –Ω–µ —É–≤–µ—Ä–µ–Ω': 1, '–ù–µ –∏—Å–ø–æ–ª—å–∑—É—é': 1, '–°–æ–≤—Å–µ–º –Ω–µ —É–º–µ—é': 1,
  '–ù–µ —Å–ø—Ä–∞–≤–ª—è—é—Å—å': 1, '–ü–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞': 1,
  // –ë–∞–ª–ª 2
  '–°–∫–æ—Ä–µ–µ –Ω–µ —É–≤–µ—Ä–µ–Ω': 2, '–ò—Å–ø–æ–ª—å–∑—É—é —Ä–µ–¥–∫–æ': 2, '–†–µ–¥–∫–æ': 2, '–ò—Å–ø–æ–ª—å–∑—É—é —à–∞–±–ª–æ–Ω—ã': 2,
  // –ë–∞–ª–ª 3
  '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ': 3, '–ò–Ω–æ–≥–¥–∞': 3, '–ò–Ω–æ–≥–¥–∞ –ø—Ä–æ—è–≤–ª—è—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å': 3,
  '–ò–Ω–æ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è': 3, '–ò–Ω–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—é': 3, '–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á': 3,
  // –ë–∞–ª–ª 4
  '–°–∫–æ—Ä–µ–µ —É–≤–µ—Ä–µ–Ω': 4, '–ß–∞—Å—Ç–æ': 4, '–ß–∞—Å—Ç–æ —É–¥–∞—ë—Ç—Å—è': 4, '–•–æ—Ä–æ—à–æ —Å–ø—Ä–∞–≤–ª—è—é—Å—å': 4,
  '–ò—Å–ø–æ–ª—å–∑—É—é —Ä–µ–≥—É–ª—è—Ä–Ω–æ': 4,
  // –ë–∞–ª–ª 5
  '–ü–æ–ª–Ω–æ—Å—Ç—å—é —É–≤–µ—Ä–µ–Ω': 5, '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é': 5,
  '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏': 5,
  '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è': 5,
  '–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è': 5, '–ü–æ—Å—Ç–æ—è–Ω–Ω–æ': 5,
  '–û—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–ª—è—é—Å—å': 5, '–ü–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–æ—è–≤–ª—è—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å': 5
};

function processFile(event) {
  const file = event.target.files[0];
  const reader = new FileReader();
  reader.onload = function () {
    const rows = reader.result.split('\n').map(line => line.split(','));
    const output = document.getElementById('result');
    let html = `<table><tr><th>–§–ò–û</th><th>Soft %</th><th>Hard %</th><th>Total %</th><th>–£—Ä–æ–≤–µ–Ω—å</th></tr>`;

    rows.slice(1).forEach(row => {
      const name = row[1];
      let softScore = 0, hardScore = 0, softMax = 0, hardMax = 0;

      for (let i = 0; i < 31; i++) {
        const text = row[i + 2]?.trim();
        const value = mapping[text] || 0;
        const w = weights[i + 1] || 0;
        if (i < 22) {
          softScore += value * w;
          softMax += 5 * w;
        } else {
          hardScore += value * w;
          hardMax += 5 * w;
        }
      }

      const softPct = Math.round((softScore / softMax) * 100);
      const hardPct = Math.round((hardScore / hardMax) * 100);
      const total = Math.round(softPct * 0.6 + hardPct * 0.4);
      let level = 'üî¥ –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å';
      if (total >= 85) level = 'üü¢ –û—Ç–ª–∏—á–Ω–æ';
      else if (total >= 65) level = 'üü° –•–æ—Ä–æ—à–æ';
      else if (total >= 45) level = 'üü† –°—Ä–µ–¥–Ω–µ';

      html += `<tr><td>${name}</td><td>${softPct}</td><td>${hardPct}</td><td>${total}</td><td>${level}</td></tr>`;
    });

    html += '</table>';
    output.innerHTML = html;
  };
  reader.readAsText(file, 'UTF-8');
}
</script>
</body>
</html>
