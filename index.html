<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–û—Ü–µ–Ω–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; background: #f4f4f4; }
    h1 { text-align: center; }
    input[type=file] { margin-bottom: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #eee; }
  </style>
</head>
<body>
<h1>–û—Ü–µ–Ω–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π</h1>
<input type="file" id="fileInput" accept=".xlsx,.csv">
<div id="output"></div>

<script>
const weights = [8,7,6,7,5,8,7,6,5,6,5,8,7,6,7,5,4,5,5,4,7,5,6,5,7,8,7,6,7,6,8];

const likertMapping = {
  '–°–æ–≤—Å–µ–º –Ω–µ —É–≤–µ—Ä–µ–Ω': 1, '–°–∫–æ—Ä–µ–µ –Ω–µ —É–≤–µ—Ä–µ–Ω': 2, '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ': 3, '–°–∫–æ—Ä–µ–µ —É–≤–µ—Ä–µ–Ω': 4, '–ü–æ–ª–Ω–æ—Å—Ç—å—é —É–≤–µ—Ä–µ–Ω': 5,
  '–î–µ–º–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–π': 4, '–î–∏—Ä–µ–∫—Ç–∏–≤–Ω—ã–π': 2, '–°–∏—Ç—É–∞—Ç–∏–≤–Ω—ã–π': 5, '–õ–∏–±–µ—Ä–∞–ª—å–Ω—ã–π': 3, '–°–º–µ—à–∞–Ω–Ω—ã–π': 4,
  '–ü—Ä–æ–≤–æ–∂—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å': 5,
  '–ù–∞—Å—Ç–∞–∏–≤–∞—é –Ω–∞ —Å–≤–æ—ë–º —Ä–µ—à–µ–Ω–∏–∏, —Ç–∞–∫ –∫–∞–∫ —É–≤–µ—Ä–µ–Ω –≤ –µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏': 2,
  '–ü–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—é —Ä–µ—à–µ–Ω–∏–µ —Å —É—á—ë—Ç–æ–º –º–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã': 4,
  '–î–µ–ª–µ–≥–∏—Ä—É—é –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–µ': 3,
  '–ò–≥–Ω–æ—Ä–∏—Ä—É—é –Ω–µ—Å–æ–≥–ª–∞—Å–∏–µ, —Ç–∞–∫ –∫–∞–∫ —Å—á–∏—Ç–∞—é –µ–≥–æ –Ω–µ–æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–º': 1,
  '–ü–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞': 1, '–†–µ–¥–∫–æ': 2, '–ò–Ω–æ–≥–¥–∞': 3, '–ß–∞—Å—Ç–æ': 4, '–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞': 5,
  '–õ–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Å—å –∏ –Ω–∞—Ö–æ–∂—É –±–∞–ª–∞–Ω—Å': 5,
  '–°—Ç–∞—Ä–∞—é—Å—å —Ä–∞–∑–¥–µ–ª—è—Ç—å –ª–∏—á–Ω—É—é –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –∂–∏–∑–Ω—å': 4,
  '–û–±—Ä–∞—â–∞—é—Å—å –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫ –∫–æ–ª–ª–µ–≥–∞–º –∏–ª–∏ –¥—Ä—É–∑—å—è–º': 3,
  '–ß—É–≤—Å—Ç–≤—É—é —Å—Ç—Ä–µ—Å—Å, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å': 2,
  '–¢–µ—Ä—è—é –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –Ω–µ –º–æ–≥—É —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏': 1,
  '–°–æ–≤—Å–µ–º –Ω–µ —É–º–µ—é': 1, '–†–µ–¥–∫–æ —É–¥–∞—ë—Ç—Å—è': 2, '–ò–Ω–æ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è': 3, '–ß–∞—Å—Ç–æ —É–¥–∞—ë—Ç—Å—è': 4, '–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è': 5,
  '–°—Ç–∞—Ä–∞—é—Å—å –±—ã—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã–º –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º': 5,
  '–ò—Å–ø–æ–ª—å–∑—É—é —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤': 3,
  '–ê–¥–∞–ø—Ç–∏—Ä—É—é —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏': 4,
  '–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –ø–∏—Å—å–º–µ–Ω–Ω—É—é –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é –¥–ª—è —á—ë—Ç–∫–æ—Å—Ç–∏': 2,
  '–ò–∑–±–µ–≥–∞—é –ª–∏—à–Ω–µ–≥–æ –æ–±—â–µ–Ω–∏—è, —Å–æ—Å—Ä–µ–¥–æ—Ç–∞—á–∏–≤–∞—è—Å—å –Ω–∞ –∑–∞–¥–∞—á–∞—Ö': 1,
  '–ü—Ä–æ–≤–æ–∂—É –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –±–µ—Å–µ–¥—ã —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞': 4,
  '–û—Ä–≥–∞–Ω–∏–∑—É—é –∫–æ–º–∞–Ω–¥–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ—à–µ–Ω–∏—è': 5,
  '–ü–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é –∑–∞–¥–∞—á–∏, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ': 3,
  '–ò–≥–Ω–æ—Ä–∏—Ä—É—é –∫–æ–Ω—Ñ–ª–∏–∫—Ç, –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ –æ–Ω —Ä–∞–∑—Ä–µ—à–∏—Ç—Å—è —Å–∞–º': 2,
  '–£–≤–æ–ª—å–Ω—è—é —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –º–æ–≥—É—Ç –¥–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è': 1,
  '–ù–µ —Å–ø—Ä–∞–≤–ª—è—é—Å—å': 1, '–° —Ç—Ä—É–¥–æ–º': 2, '–£–º–µ—Ä–µ–Ω–Ω–æ': 3, '–•–æ—Ä–æ—à–æ': 4, '–û—Ç–ª–∏—á–Ω–æ': 5,
  '–ë–µ–∑ —Å–∏—Å—Ç–µ–º—ã': 1, '–ò—Å–ø–æ–ª—å–∑—É—é –ø—Ä–æ—Å—Ç—ã–µ —Å–ø–∏—Å–∫–∏': 2, '–ò—Å–ø–æ–ª—å–∑—É—é —Ç–∞—Å–∫-–º–µ–Ω–µ–¥–∂–µ—Ä—ã': 3, '–ò—Å–ø–æ–ª—å–∑—É—é —Å–ª–æ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è': 4, '–î–µ–ª–µ–≥–∏—Ä—É—é –∑–∞–¥–∞—á–∏ –∫–æ–º–∞–Ω–¥–µ': 5,
  '–£–≤–µ–ª–∏—á–∏–≤–∞—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ –ø—Ä–æ–µ–∫—Ç': 2,
  '–ü–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—é —Å—Ä–æ–∫–∏ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∑–∞–¥–∞—á': 3,
  '–ü—Ä–æ–≤–æ–∂—É –≤—Å—Ç—Ä–µ—á—É —Å –∫–æ–º–∞–Ω–¥–æ–π –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ—à–µ–Ω–∏–π': 4,
  '–£—Å–∫–æ—Ä—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –∑–∞ —Å—á—ë—Ç –∫–∞—á–µ—Å—Ç–≤–∞': 1,
  '–û–±—Ä–∞—â–∞—é—Å—å –∑–∞ –ø–æ–º–æ—â—å—é –∫ –≤–Ω–µ—à–Ω–∏–º –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞–º': 3,
  '–ù–µ—Ç': 1, '–î–∞': 5,
  '–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É–ø—Ä–∞–≤–ª—è–ª(–∞) –ø—Ä–æ–µ–∫—Ç–∞–º–∏': 1,
  '–£–ø—Ä–∞–≤–ª—è–ª(–∞) –Ω–µ–±–æ–ª—å—à–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ (–¥–æ 3 –º–µ—Å—è—Ü–µ–≤)': 2,
  '–£–ø—Ä–∞–≤–ª—è–ª(–∞) –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (3-12 –º–µ—Å—è—Ü–µ–≤)': 3,
  '–£–ø—Ä–∞–≤–ª—è–ª(–∞) —Å–ª–æ–∂–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ (12+ –º–µ—Å—è—Ü–µ–≤)': 4,
  '–ù–µ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª(–∞)': 1,
  '–£—á–∞—Å—Ç–≤–æ–≤–∞–ª(–∞) –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏—è—Ö': 2,
  '–£—á–∞—Å—Ç–≤–æ–≤–∞–ª(–∞) –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —á–∞—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏': 3,
  '–£—á–∞—Å—Ç–≤–æ–≤–∞–ª(–∞) –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –æ–±—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏': 4,
  '–£—á–∞—Å—Ç–≤–æ–≤–∞–ª(–∞) –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏': 5,
  '–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É–ø—Ä–∞–≤–ª—è–ª(–∞) –∫–æ–º–∞–Ω–¥–æ–π': 1,
  '–£–ø—Ä–∞–≤–ª—è–ª(–∞) –Ω–µ–±–æ–ª—å—à–æ–π –∫–æ–º–∞–Ω–¥–æ–π (–¥–æ 5 —á–µ–ª–æ–≤–µ–∫)': 2,
  '–£–ø—Ä–∞–≤–ª—è–ª(–∞) —Å—Ä–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥–æ–π (6-15 —á–µ–ª–æ–≤–µ–∫)': 3,
  '–£–ø—Ä–∞–≤–ª—è–ª(–∞) –±–æ–ª—å—à–æ–π –∫–æ–º–∞–Ω–¥–æ–π (16+ —á–µ–ª–æ–≤–µ–∫)': 4,
  '–£–ø—Ä–∞–≤–ª—è–ª(–∞) —É–¥–∞–ª—ë–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π': 5,
  'Beginner (A1)': 1, 'Elementary (A2)': 2, 'Pre-Intermediate (B1)': 2,
  'Intermediate (B1)': 3, 'Upper Intermediate (B2)': 4, 'Advanced (C1)': 5, 'Proficiency (C2)': 5,
  '–ò—Å–ø–æ–ª—å–∑—É—é —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏': 2,
  '–£–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã –∏ –≥—Ä—É–ø–ø—ã': 3,
  '–£–º–µ—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏': 4,
  '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏': 5,
  '–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á': 2,
  '–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç—ã': 3,
  '–£–º–µ—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ workflows': 4,
  '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è': 5,
  '–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞': 3,
  '–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö': 4,
  '–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É—é –≤ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã –∫–æ–º–ø–∞–Ω–∏–∏': 5,
  '–°–æ–∑–¥–∞—é –ø—Ä–æ—Å—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏': 3,
  '–°–æ–∑–¥–∞—é —Å–ª–æ–∂–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏': 4,
  '–†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—é –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤': 5,
  '–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤': 2,
  '–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã': 3,
  '–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É—é –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –º–µ–∂–¥—É —Å–æ–±–æ–π': 4,
  '–°—Ç—Ä–æ—é –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ –≤—Å—é —Ü–∏—Ñ—Ä–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–º–ø–∞–Ω–∏–∏': 5,
  '–£–º–µ—é —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–æ—Å—Ç—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏': 2,
  '–£–º–µ—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—ã –∏ —Å–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã': 3,
  '–£–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã': 4,
  '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞': 5,
  '–ü–æ–ª–∞–≥–∞—é—Å—å –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥—Ä—É–≥–∏—Ö': 2,
  '–ú–æ–≥—É –≤—ã–±—Ä–∞—Ç—å –∏–∑ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –º–Ω–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤': 3,
  '–ü—Ä–æ–≤–æ–∂—É —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–æ–º': 4,
  '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –ø–æ–¥–±–∏—Ä–∞—é –∏ –≤–Ω–µ–¥—Ä—è—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã': 5
};

function handleFile(file) {
  const reader = new FileReader();
  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, { type: 'array' });
    const sheetName = workbook.SheetNames[0];
    const worksheet = workbook.Sheets[sheetName];
    const json = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
    displayResults(json);
  };
  reader.readAsArrayBuffer(file);
}

function displayResults(data) {
  let output = '<table><tr><th>–§–ò–û</th><th>Soft %</th><th>Hard %</th><th>Total %</th><th>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</th></tr>';
  const header = data[0];

  data.slice(1).forEach(row => {
    const name = row[1];
    let softScore = 0, hardScore = 0, softMax = 0, hardMax = 0;
    for (let i = 0; i < 31; i++) {
      const answer = (row[i + 3] || '').trim();
      const value = likertMapping[answer] || 0;
      const weight = weights[i];
      if (i < 22) {
        softScore += value * weight;
        softMax += 5 * weight;
      } else {
        hardScore += value * weight;
        hardMax += 5 * weight;
      }
    }
    const softPct = Math.round((softScore / softMax) * 100);
    const hardPct = Math.round((hardScore / hardMax) * 100);
    const total = Math.round(softPct * 0.6 + hardPct * 0.4);

    let interpretation = 'üî¥ –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å';
    if (total >= 85) interpretation = 'üü¢ –û—Ç–ª–∏—á–Ω–æ ‚Äì –∑—Ä–µ–ª—ã–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏';
    else if (total >= 65) interpretation = 'üü° –•–æ—Ä–æ—à–æ ‚Äì –µ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª';
    else if (total >= 45) interpretation = 'üü† –°—Ä–µ–¥–Ω–µ ‚Äì —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑–≤–∏—Ç–∏–µ';

    output += `<tr><td>${name}</td><td>${softPct}</td><td>${hardPct}</td><td>${total}</td><td>${interpretation}</td></tr>`;
  });
  output += '</table>';
  document.getElementById('output').innerHTML = output;
}

document.getElementById('fileInput').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (file) handleFile(file);
});
</script>
</body>
</html>
