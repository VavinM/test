<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–¢–µ—Å—Ç –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π: –∞–Ω–∞–ª–∏–∑ –∏ —Ä–∞–∑–±–∞–ª–æ–≤–∫–∞</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #fafafa; margin: 0; padding: 30px;}
    h1 { text-align: center; margin-bottom: 10px;}
    h2 { margin: 30px 0 10px 0; }
    .file-box { margin-bottom: 25px; text-align: center;}
    .warn { color: #d32f2f; background: #fff0f0;}
    table { border-collapse: collapse; width: 100%; margin-bottom: 35px;}
    th, td { border: 1px solid #ccc; padding: 7px 10px; }
    th { background: #f3f3f3;}
    .score-err { background: #ffefef; color: #d32f2f; font-weight: bold;}
    .summary { font-weight: bold; background: #e8eaf6;}
    .ok { color: #388e3c;}
    .mid { color: #ff9800;}
    .low { color: #d32f2f;}
    .good { color: #1976d2;}
    .unknown { color: #d32f2f;}
    .result-box { margin: 0 auto; max-width: 1150px; }
    .details-title { font-size: 1.2em; font-weight: bold; margin: 25px 0 5px;}
  </style>
</head>
<body>
  <h1>–¢–µ—Å—Ç –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π</h1>
  <div class="file-box">
    <input type="file" id="fileInput" accept=".xlsx,.csv"/>
  </div>
  <div class="result-box" id="output"></div>

<script>
/* ======================= –ú–ê–°–°–ò–í –í–ï–°–û–í ======================= */
const weights = [
  8,7,6,7,5,8,7,6,5,6,5,8,7,6,7,5,4,5,5,4,7,5,  // 1‚Äì22 (soft)
  6,5,7,8,7,6,7,6,8                             // 23‚Äì31 (hard)
];

/* ===================== –°–õ–û–í–ê–†–¨ –û–¢–í–ï–¢–û–í =======================
  !!! –í–ù–ò–ú–ê–ù–ò–ï: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ø–æ–ª–Ω–∏ –∑–¥–µ—Å—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ (–∫–æ–ø–∏—Ä—É–π –∏–∑ Google-—Ñ–æ—Ä–º) !!!
  –§–æ—Ä–º–∞—Ç: "–í–∞—Ä–∏–∞–Ω—Ç –∏–∑ —Ñ–æ—Ä–º—ã": –±–∞–ª–ª
  –î–æ–±–∞–≤–ª—è–π –Ω–æ–≤—ã–µ –±–µ–∑ —Å—Ç–µ—Å–Ω–µ–Ω–∏—è!
*/
const likertMapping = {
  // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —à–∫–∞–ª–∞ –õ–∞–π–∫–µ—Ä—Ç–∞:
  "–°–æ–≤—Å–µ–º –Ω–µ —É–≤–µ—Ä–µ–Ω": 1, "–°–∫–æ—Ä–µ–µ –Ω–µ —É–≤–µ—Ä–µ–Ω": 2, "–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ": 3, "–°–∫–æ—Ä–µ–µ —É–≤–µ—Ä–µ–Ω": 4, "–ü–æ–ª–Ω–æ—Å—Ç—å—é —É–≤–µ—Ä–µ–Ω": 5,
  "–î–µ–º–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–π": 4, "–î–∏—Ä–µ–∫—Ç–∏–≤–Ω—ã–π": 2, "–°–∏—Ç—É–∞—Ç–∏–≤–Ω—ã–π": 5, "–õ–∏–±–µ—Ä–∞–ª—å–Ω—ã–π": 3, "–°–º–µ—à–∞–Ω–Ω—ã–π": 4,
  "–ü—Ä–æ–≤–æ–∂—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å": 5,
  "–ù–∞—Å—Ç–∞–∏–≤–∞—é –Ω–∞ —Å–≤–æ—ë–º —Ä–µ—à–µ–Ω–∏–∏, —Ç–∞–∫ –∫–∞–∫ —É–≤–µ—Ä–µ–Ω –≤ –µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏": 2,
  "–ü–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—é —Ä–µ—à–µ–Ω–∏–µ —Å —É—á—ë—Ç–æ–º –º–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã": 4,
  "–î–µ–ª–µ–≥–∏—Ä—É—é –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–µ": 3,
  "–ò–≥–Ω–æ—Ä–∏—Ä—É—é –Ω–µ—Å–æ–≥–ª–∞—Å–∏–µ, —Ç–∞–∫ –∫–∞–∫ —Å—á–∏—Ç–∞—é –µ–≥–æ –Ω–µ–æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–º": 1,
  "–ü–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞": 1, "–†–µ–¥–∫–æ": 2, "–ò–Ω–æ–≥–¥–∞": 3, "–ß–∞—Å—Ç–æ": 4, "–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞": 5,
  "–õ–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Å—å –∏ –Ω–∞—Ö–æ–∂—É –±–∞–ª–∞–Ω—Å": 5,
  "–°—Ç–∞—Ä–∞—é—Å—å —Ä–∞–∑–¥–µ–ª—è—Ç—å –ª–∏—á–Ω—É—é –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –∂–∏–∑–Ω—å": 4,
  "–û–±—Ä–∞—â–∞—é—Å—å –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫ –∫–æ–ª–ª–µ–≥–∞–º –∏–ª–∏ –¥—Ä—É–∑—å—è–º": 3,
  "–ß—É–≤—Å—Ç–≤—É—é —Å—Ç—Ä–µ—Å—Å, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å": 2,
  "–¢–µ—Ä—è—é –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –Ω–µ –º–æ–≥—É —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏": 1,
  "–°–æ–≤—Å–µ–º –Ω–µ —É–º–µ—é": 1, "–†–µ–¥–∫–æ —É–¥–∞—ë—Ç—Å—è": 2, "–ò–Ω–æ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è": 3, "–ß–∞—Å—Ç–æ —É–¥–∞—ë—Ç—Å—è": 4, "–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è": 5,
  "–ù–µ—Ç": 1, "–î–∞": 5,
  "–ù–µ —Å–ø—Ä–∞–≤–ª—è—é—Å—å": 1, "–° —Ç—Ä—É–¥–æ–º": 2, "–£–º–µ—Ä–µ–Ω–Ω–æ": 3, "–•–æ—Ä–æ—à–æ": 4, "–û—Ç–ª–∏—á–Ω–æ": 5,
  "–ë–µ–∑ —Å–∏—Å—Ç–µ–º—ã": 1, "–ò—Å–ø–æ–ª—å–∑—É—é –ø—Ä–æ—Å—Ç—ã–µ —Å–ø–∏—Å–∫–∏": 2, "–ò—Å–ø–æ–ª—å–∑—É—é —Ç–∞—Å–∫-–º–µ–Ω–µ–¥–∂–µ—Ä—ã": 3,
  "–ò—Å–ø–æ–ª—å–∑—É—é —Å–ª–æ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è": 4, "–î–µ–ª–µ–≥–∏—Ä—É—é –∑–∞–¥–∞—á–∏ –∫–æ–º–∞–Ω–¥–µ": 5,
  "–£–≤–µ–ª–∏—á–∏–≤–∞—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ –ø—Ä–æ–µ–∫—Ç": 4, "–ü–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—é —Å—Ä–æ–∫–∏ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∑–∞–¥–∞—á": 3,
  "–ü—Ä–æ–≤–æ–∂—É –≤—Å—Ç—Ä–µ—á—É —Å –∫–æ–º–∞–Ω–¥–æ–π –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ—à–µ–Ω–∏–π": 5, "–£—Å–∫–æ—Ä—è—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –∑–∞ —Å—á—ë—Ç –∫–∞—á–µ—Å—Ç–≤–∞": 2,
  "–û–±—Ä–∞—â–∞—é—Å—å –∑–∞ –ø–æ–º–æ—â—å—é –∫ –≤–Ω–µ—à–Ω–∏–º –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞–º": 1,
  "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏": 5,
  "–ò—Å–ø–æ–ª—å–∑—É—é —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏": 2, "–£–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã –∏ –≥—Ä—É–ø–ø—ã": 3, "–£–º–µ—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏": 4,
  "–ù–µ –∏—Å–ø–æ–ª—å–∑—É—é": 1, "–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á": 2, "–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç—ã": 3, "–£–º–µ—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ workflows": 4,
  "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è": 5,
  "–ò—Å–ø–æ–ª—å–∑—É—é –≥–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã": 2, "–°–æ–∑–¥–∞—é –ø—Ä–æ—Å—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏": 3, "–°–æ–∑–¥–∞—é —Å–ª–æ–∂–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏": 4,
  "–†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—é –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤": 5,
  "–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞": 3, "–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö": 4, "–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É—é –≤ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã –∫–æ–º–ø–∞–Ω–∏–∏": 5,
  "–ü–æ–ª–∞–≥–∞—é—Å—å –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥—Ä—É–≥–∏—Ö": 2, "–ú–æ–≥—É –≤—ã–±—Ä–∞—Ç—å –∏–∑ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –º–Ω–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤": 3,
  "–ü—Ä–æ–≤–æ–∂—É —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–æ–º": 4, "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –ø–æ–¥–±–∏—Ä–∞—é –∏ –≤–Ω–µ–¥—Ä—è—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã": 5,
  "–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤": 2, "–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã": 3,
  "–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É—é –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –º–µ–∂–¥—É —Å–æ–±–æ–π": 4,
  "–°—Ç—Ä–æ—é –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ –≤—Å—é —Ü–∏—Ñ—Ä–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–º–ø–∞–Ω–∏–∏": 5,
  "–£–º–µ—é —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–æ—Å—Ç—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏": 2, "–£–º–µ—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—ã –∏ —Å–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã": 3,
  "–£–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã": 4, "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞": 5,
  // –†–∞—Å—à–∏—Ä—è–π—Ç–µ —Å–ø–∏—Å–æ–∫!
};

/* =================== –ü–ê–†–°–ò–ù–ì –¢–ê–ë–õ–ò–¶–´ =================== */
function isFioColumn(col) {
  const fio = col.trim().toLowerCase();
  return fio.includes("—Ñ–∏–æ") || fio.includes("—Ñ–∞–º–∏–ª–∏—è") || fio.includes("–∏–º—è");
}

/* ========== –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ö–ò ========== */
document.getElementById('fileInput').addEventListener('change', function(e) {
  if (!e.target.files[0]) return;
  const reader = new FileReader();
  reader.onload = function(ev) {
    let data = new Uint8Array(ev.target.result);
    let workbook = XLSX.read(data, {type: 'array'});
    let sheet = workbook.Sheets[workbook.SheetNames[0]];
    let rows = XLSX.utils.sheet_to_json(sheet, {header: 1});

    // –ù–∞–π–¥—ë–º —Å—Ç—Ä–æ–∫—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏–º —Å—Ç–æ–ª–±—Ü—ã
    let headerIdx = rows.findIndex(row => row.some(isFioColumn));
    if (headerIdx === -1) { document.getElementById('output').innerHTML = "<p class='warn'>–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –§–ò–û –Ω–µ –Ω–∞–π–¥–µ–Ω!</p>"; return;}
    const header = rows[headerIdx];
    let fioCol = header.findIndex(isFioColumn);

    // –û–±—Ä–µ–∂–µ–º –ª–∏—à–Ω–µ–µ
    rows = rows.slice(headerIdx + 1).filter(row => (row[fioCol] && row.length > fioCol + 10)); // –æ—Å—Ç–∞–≤–ª—è–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏

    let resultHTML = "";
    let summaryRows = "";

    rows.forEach((row, idx) => {
      const name = (row[fioCol] || "-").toString().trim();
      let softScore = 0, hardScore = 0, softMax = 0, hardMax = 0, details = "";
      let qNum = 1;
      // –î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–±–∞–ª–æ–≤–∫–∞
      details += `<h2>–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–±–∞–ª–æ–≤–∫–∞ –¥–ª—è: ${name}</h2>
      <table>
        <tr><th>–í–æ–ø—Ä–æ—Å</th><th>–û—Ç–≤–µ—Ç</th><th>–ë–∞–ª–ª</th></tr>`;
      for (let i = 0; i < 31; i++) {
        const ansIdx = fioCol + 1 + i;
        const answer = (row[ansIdx] || "").toString().trim();
        const score = answer in likertMapping ? likertMapping[answer] : 0;
        const warn = score === 0 && answer ? "<span class='score-err'>0 (–Ω–µ—Ç —Ä–∞–∑–±–∞–ª–æ–≤–∫–∏!)</span>" : score;
        if (i < 22) {
          softScore += score * weights[i];
          softMax += 5 * weights[i];
        } else {
          hardScore += score * weights[i];
          hardMax += 5 * weights[i];
        }
        details += `<tr><td>–í–æ–ø—Ä–æ—Å ${qNum++}</td><td>${answer || "-"}</td><td class="${score === 0 && answer ? "score-err" : ""}">${warn}</td></tr>`;
      }
      details += "</table>";

      // –ò—Ç–æ–≥–æ–≤—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã
      const softPct = Math.round(softScore / softMax * 100);
      const hardPct = Math.round(hardScore / hardMax * 100);
      const total = Math.round(softPct * 0.6 + hardPct * 0.4);

      // –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
      let interp = `<span class="low">üî¥ –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å</span>`;
      if (total >= 85) interp = `<span class="ok">üü¢ –û—Ç–ª–∏—á–Ω–æ ‚Äì –∑—Ä–µ–ª—ã–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏</span>`;
      else if (total >= 65) interp = `<span class="good">üü° –•–æ—Ä–æ—à–∏–π —É—Ä–æ–≤–µ–Ω—å</span>`;
      else if (total >= 45) interp = `<span class="mid">üü† –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</span>`;

      // –°–≤–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
      summaryRows += `<tr><td>${name}</td><td>${softPct}</td><td>${hardPct}</td><td>${total}</td><td>${interp}</td></tr>`;
      // –î–µ—Ç–∞–ª–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—É
      resultHTML += `<div class='details-title'>${name}</div>${details}<br/>`;
    });

    // –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞
    let summaryTable = `<h2>–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h2>
    <table><tr>
      <th>–§–ò–û</th><th>Soft %</th><th>Hard %</th><th>Total %</th><th>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</th>
    </tr>${summaryRows}</table>`;

    document.getElementById('output').innerHTML = summaryTable + "<hr>" + resultHTML +
      `<div style="margin-top:25px;color:#666;font-size:0.97em">
        <b>NB:</b> –ï—Å–ª–∏ –≤ —Å—Ç—Ä–æ–∫–µ –±–∞–ª–ª–æ–≤ "0 (–Ω–µ—Ç —Ä–∞–∑–±–∞–ª–æ–≤–∫–∏!)" ‚Äî –¥–æ–±–∞–≤—å —ç—Ç–æ—Ç –æ—Ç–≤–µ—Ç –≤ –æ–±—ä–µ–∫—Ç <b>likertMapping</b> –≤ –∫–æ–¥–µ!
      </div>`;
  };
  reader.readAsArrayBuffer(e.target.files[0]);
});
</script>
</body>
</html>
