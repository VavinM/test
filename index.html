<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–û—Ü–µ–Ω–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial; padding: 24px; background: #f9f9f9; }
    h1 { text-align: center; }
    .error { color: #c00; font-weight: bold; }
    table { border-collapse: collapse; margin-top: 20px; width: 100%; background: #fff; }
    th, td { border: 1px solid #bbb; padding: 6px 8px; }
    th { background: #e9e9e9; }
    tr.warn td { background: #fff6f6; color: #c00; }
    .variant-table { margin-bottom: 32px; }
    .explain { color: #555; margin: 10px 0 24px 0; }
  </style>
</head>
<body>
  <h1>–†–∞–∑–±–∞–ª–ª–æ–≤–∫–∞ —Ç–µ—Å—Ç–∞ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π (–∞–≤—Ç–æ—Ä–∞–∑–±–æ—Ä)</h1>
  <div class="explain">
    –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É –æ—Ç–≤–µ—Ç–æ–≤ (.xlsx/.csv) ‚Äî —É–≤–∏–¥–∏—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞, –∫–∞–∫–æ–π –±–∞–ª–ª –µ–º—É –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –∏ –∏—Ç–æ–≥ —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞.<br>
    –ù–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è. –ú–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å —Å–ª–æ–≤–∞—Ä—å –ø—Ä—è–º–æ –≤ –∫–æ–¥–µ.<br>
  </div>
  <input type="file" id="fileInput" accept=".xlsx,.csv">
  <div id="variants"></div>
  <div id="output"></div>

<script>
// –í–µ—Å–æ–≤—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã ‚Äî –ø–æ–ø—Ä–∞–≤—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏!
const weights = [8,7,6,7,5,8,7,6,5,6,5,8,7,6,7,5,4,5,5,4,7,5,6,5,7,8,7,6,7,6,8];

// –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π mapping (–¥–æ–±–∞–≤–ª—è–π —Å–≤–æ–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏):
const likertMapping = {
  // Soft (1-22)
  '–°–æ–≤—Å–µ–º –Ω–µ —É–≤–µ—Ä–µ–Ω': 1, '–°–∫–æ—Ä–µ–µ –Ω–µ —É–≤–µ—Ä–µ–Ω': 2, '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ': 3, '–°–∫–æ—Ä–µ–µ —É–≤–µ—Ä–µ–Ω': 4, '–ü–æ–ª–Ω–æ—Å—Ç—å—é —É–≤–µ—Ä–µ–Ω': 5,
  '–î–µ–º–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–π': 4, '–î–∏—Ä–µ–∫—Ç–∏–≤–Ω—ã–π': 2, '–°–∏—Ç—É–∞—Ç–∏–≤–Ω—ã–π': 5, '–õ–∏–±–µ—Ä–∞–ª—å–Ω—ã–π': 3, '–°–º–µ—à–∞–Ω–Ω—ã–π': 4,
  '–ü—Ä–æ–≤–æ–∂—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å': 5,
  '–ù–∞—Å—Ç–∞–∏–≤–∞—é –Ω–∞ —Å–≤–æ—ë–º —Ä–µ—à–µ–Ω–∏–∏, —Ç–∞–∫ –∫–∞–∫ —É–≤–µ—Ä–µ–Ω –≤ –µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏': 2,
  '–ü–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—é —Ä–µ—à–µ–Ω–∏–µ —Å —É—á—ë—Ç–æ–º –º–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã': 4,
  '–î–µ–ª–µ–≥–∏—Ä—É—é –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–µ': 3,
  '–ò–≥–Ω–æ—Ä–∏—Ä—É—é –Ω–µ—Å–æ–≥–ª–∞—Å–∏–µ, —Ç–∞–∫ –∫–∞–∫ —Å—á–∏—Ç–∞—é –µ–≥–æ –Ω–µ–æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–º': 1,
  '–ü–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞': 1, '–†–µ–¥–∫–æ': 2, '–ò–Ω–æ–≥–¥–∞': 3, '–ß–∞—Å—Ç–æ': 4, '–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞': 5,
  '–õ–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Å—å –∏ –Ω–∞—Ö–æ–∂—É –±–∞–ª–∞–Ω—Å': 5,
  '–°—Ç–∞—Ä–∞—é—Å—å —Ä–∞–∑–¥–µ–ª—è—Ç—å –ª–∏—á–Ω—É—é –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –∂–∏–∑–Ω—å': 4,
  '–û–±—Ä–∞—â–∞—é—Å—å –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫ –∫–æ–ª–ª–µ–≥–∞–º –∏–ª–∏ –¥—Ä—É–∑—å—è–º': 3,
  '–ß—É–≤—Å—Ç–≤—É—é —Å—Ç—Ä–µ—Å—Å, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å': 2,
  '–¢–µ—Ä—è—é –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –Ω–µ –º–æ–≥—É —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏': 1,
  '–°–æ–≤—Å–µ–º –Ω–µ —É–º–µ—é': 1, '–†–µ–¥–∫–æ —É–¥–∞—ë—Ç—Å—è': 2, '–ò–Ω–æ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è': 3, '–ß–∞—Å—Ç–æ —É–¥–∞—ë—Ç—Å—è': 4, '–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è': 5,
  // Hard (23-31) ‚Äî –ø—Ä–∏–º–µ—Ä—ã, –¥–æ–ø–æ–ª–Ω—è–π!
  '–ù–µ –∏—Å–ø–æ–ª—å–∑—É—é': 1,
  '–ò—Å–ø–æ–ª—å–∑—É—é —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏': 2,
  '–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á': 2,
  '–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç—ã': 3,
  '–£–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã –∏ –≥—Ä—É–ø–ø—ã': 3,
  '–£–º–µ—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ workflows': 4,
  '–£–º–µ—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏': 4,
  '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è': 5,
  '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏': 5,
  '–î–∞': 5, '–ù–µ—Ç': 1
};

// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞
function handleFile(file) {
  const reader = new FileReader();
  reader.onload = function(e) {
    let data;
    if (file.name.endsWith('.csv')) {
      // –î–ª—è csv ‚Äî —Ä–∞–∑–±–∏—Ä–∞–µ–º –≤—Ä—É—á–Ω—É—é
      const text = e.target.result;
      data = text.split(/\\r?\\n/).map(r=>r.split(';').map(x=>x.trim()));
    } else {
      // –î–ª—è xlsx
      const workbook = XLSX.read(e.target.result, {type: 'array'});
      const sheet = workbook.Sheets[workbook.SheetNames[0]];
      data = XLSX.utils.sheet_to_json(sheet, {header:1});
    }
    showVariants(data);
    displayResults(data);
  };
  if (file.name.endsWith('.csv')) reader.readAsText(file, 'utf-8');
  else reader.readAsArrayBuffer(file);
}

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ –±–∞–ª–ª—ã
function showVariants(data) {
  let variantsSet = new Set();
  data.slice(1).forEach(row => {
    for (let i = 3; i < 3+weights.length; i++) {
      const v = (row[i] || '').replace(/^\"|\"$/g, '').trim();
      if (v) variantsSet.add(v);
    }
  });
  let html = '<h3>–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤</h3><table class=\"variant-table\"><tr><th>–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞</th><th>–ë–∞–ª–ª</th></tr>';
  let warnRows = [];
  for (let v of Array.from(variantsSet)) {
    if (likertMapping[v] !== undefined) {
      html += `<tr><td>${v}</td><td>${likertMapping[v]}</td></tr>`;
    } else {
      warnRows.push(`<tr class='warn'><td>${v}</td><td>‚ùóÔ∏è–ù–µ—Ç —Ä–∞–∑–±–∞–ª–æ–≤–∫–∏ (–±—É–¥–µ—Ç 0!)</td></tr>`);
    }
  }
  html += warnRows.join('');
  html += '</table>';
  document.getElementById('variants').innerHTML = html;
}

// –í—ã–≤–æ–¥–∏–º –±–∞–ª–ª—ã —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–æ–≤
function displayResults(data) {
  let output = '<table><tr><th>–§–ò–û</th><th>Soft %</th><th>Hard %</th><th>Total %</th><th>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</th></tr>';
  data.slice(1).forEach(row => {
    const name = (row[1] || row[0] || '‚Äî').toString().trim();
    let softScore = 0, hardScore = 0, softMax = 0, hardMax = 0;
    for (let i = 0; i < weights.length; i++) {
      const ans = (row[i + 3] || '').replace(/^\"|\"$/g, '').trim();
      const value = likertMapping[ans] !== undefined ? likertMapping[ans] : 0;
      const weight = weights[i];
      if (i < 22) {
        softScore += value * weight;
        softMax += 5 * weight;
      } else {
        hardScore += value * weight;
        hardMax += 5 * weight;
      }
    }
    const softPct = Math.round((softScore / softMax) * 100);
    const hardPct = Math.round((hardScore / hardMax) * 100);
    const total = Math.round(softPct * 0.6 + hardPct * 0.4);
    let interpretation = 'üî¥ –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å';
    if (total >= 85) interpretation = 'üü¢ –û—Ç–ª–∏—á–Ω–æ ‚Äì –∑—Ä–µ–ª—ã–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏';
    else if (total >= 65) interpretation = 'üü° –•–æ—Ä–æ—à–æ ‚Äì –µ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª';
    else if (total >= 45) interpretation = 'üü† –°—Ä–µ–¥–Ω–µ ‚Äì —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑–≤–∏—Ç–∏–µ';

    output += `<tr><td>${name}</td><td>${softPct}</td><td>${hardPct}</td><td>${total}</td><td>${interpretation}</td></tr>`;
  });
  output += '</table>';
  document.getElementById('output').innerHTML = output;
}

document.getElementById('fileInput').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (file) handleFile(file);
});
</script>
</body>
</html>
