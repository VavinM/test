<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–¢–µ—Å—Ç –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #fafafa; }
    h1 { text-align: center; }
    #fioSelect { margin-bottom: 20px; }
    .warning { color: #b71c1c; background: #fde0e0; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 30px; }
    th, td { border: 1px solid #ccc; padding: 7px; }
    th { background: #eee; }
    .result-block { font-size: 1.2em; margin-bottom: 20px; }
    .score { font-size: 1.4em; font-weight: bold; margin: 10px 0; }
    .level { font-weight: bold; }
    .low { color: #b71c1c; }
    .medium { color: #ff9800; }
    .good { color: #2196f3; }
    .high { color: #388e3c; }
    .centered { text-align: center; }
  </style>
</head>
<body>
  <h1>–¢–µ—Å—Ç –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π</h1>
  <input type="file" id="fileInput" accept=".xlsx,.csv">
  <br>
  <label for="fioSelect"><b>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞:</b></label>
  <select id="fioSelect"></select>
  <div id="personResult"></div>
  <div id="details"></div>
  <div id="summary"></div>
  <script>
    // === –†–∞–∑–±–∞–ª–ª–æ–≤–∫–∞ ===
    const likertMapping = {
  // 1. –õ–∞–π–∫–µ—Ä—Ç –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏, –Ω–∞–≤—ã–∫–æ–≤, —á–∞—Å—Ç–æ—Ç—ã –∏ —Ç.–¥.
  "–°–æ–≤—Å–µ–º –Ω–µ —É–≤–µ—Ä–µ–Ω": 1,
  "–°–∫–æ—Ä–µ–µ –Ω–µ —É–≤–µ—Ä–µ–Ω": 2,
  "–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ": 3,
  "–°–∫–æ—Ä–µ–µ —É–≤–µ—Ä–µ–Ω": 4,
  "–ü–æ–ª–Ω–æ—Å—Ç—å—é —É–≤–µ—Ä–µ–Ω": 5,
  "–°–æ–≤—Å–µ–º –Ω–µ —É–º–µ—é": 1,
  "–†–µ–¥–∫–æ —É–¥–∞—ë—Ç—Å—è": 2,
  "–ò–Ω–æ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è": 3,
  "–ß–∞—Å—Ç–æ —É–¥–∞—ë—Ç—Å—è": 4,
  "–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è": 5,

  // 2. –°—Ç–∏–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  "–î–µ–º–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–π": 4,
  "–î–∏—Ä–µ–∫—Ç–∏–≤–Ω—ã–π": 2,
  "–°–∏—Ç—É–∞—Ç–∏–≤–Ω—ã–π": 5,
  "–õ–∏–±–µ—Ä–∞–ª—å–Ω—ã–π": 3,
  "–°–º–µ—à–∞–Ω–Ω—ã–π": 4,

  // 3. –†–µ—à–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ/–æ–±—Å—É–∂–¥–µ–Ω–∏–∏
  "–ü—Ä–æ–≤–æ–∂—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å": 5,
  "–ù–∞—Å—Ç–∞–∏–≤–∞—é –Ω–∞ —Å–≤–æ—ë–º —Ä–µ—à–µ–Ω–∏–∏, —Ç–∞–∫ –∫–∞–∫ —É–≤–µ—Ä–µ–Ω –≤ –µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏": 2,
  "–ü–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—é —Ä–µ—à–µ–Ω–∏–µ —Å —É—á—ë—Ç–æ–º –º–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã": 4,
  "–î–µ–ª–µ–≥–∏—Ä—É—é –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–µ": 3,
  "–ò–≥–Ω–æ—Ä–∏—Ä—É—é –Ω–µ—Å–æ–≥–ª–∞—Å–∏–µ, —Ç–∞–∫ –∫–∞–∫ —Å—á–∏—Ç–∞—é –µ–≥–æ –Ω–µ–æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–º": 1,

  // 4. –û—Ü–µ–Ω–∫–∞ —á–∞—Å—Ç–æ—Ç—ã, –≥–∏–±–∫–æ—Å—Ç–∏, –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
  "–ü–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞": 1,
  "–†–µ–¥–∫–æ": 2,
  "–ò–Ω–æ–≥–¥–∞": 3,
  "–ß–∞—Å—Ç–æ": 4,
  "–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞": 5,

  // 5. –ê–¥–∞–ø—Ç–∞—Ü–∏—è, —Å—Ç—Ä–µ—Å—Å
  "–õ–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Å—å –∏ –Ω–∞—Ö–æ–∂—É –±–∞–ª–∞–Ω—Å": 5,
  "–°—Ç–∞—Ä–∞—é—Å—å —Ä–∞–∑–¥–µ–ª—è—Ç—å –ª–∏—á–Ω—É—é –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –∂–∏–∑–Ω—å": 4,
  "–û–±—Ä–∞—â–∞—é—Å—å –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫ –∫–æ–ª–ª–µ–≥–∞–º –∏–ª–∏ –¥—Ä—É–∑—å—è–º": 3,
  "–ß—É–≤—Å—Ç–≤—É—é —Å—Ç—Ä–µ—Å—Å, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å": 2,
  "–¢–µ—Ä—è—é –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –Ω–µ –º–æ–≥—É —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏": 1,
  "–ß—É–≤—Å—Ç–≤—É—é —Å–∏–ª—å–Ω—ã–π —Å—Ç—Ä–µ—Å—Å, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å": 2,

  // 6. –û—Ç–≤–µ—Ç—ã –¥–∞/–Ω–µ—Ç
  "–ù–µ—Ç": 1,
  "–î–∞": 5,

  // 7. –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º —Å –Ω–∞–≤—ã–∫–∞–º–∏, –æ–ø—ã—Ç–æ–º, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏:
  "Intermediate (B1)": 3,
  "Elementary (A2)": 2,
  "Beginner (A1)": 1,
  "Pre-Intermediate (B1)": 2,
  "Upper Intermediate (B2)": 4,
  "Advanced (C1)": 5,
  "Proficiency (C2)": 5,

  // –ö–æ–º–∞–Ω–¥–Ω—ã–π –æ–ø—ã—Ç
  "–£–ø—Ä–∞–≤–ª—è–ª(–∞) –Ω–µ–±–æ–ª—å—à–æ–π –∫–æ–º–∞–Ω–¥–æ–π (–¥–æ 5 —á–µ–ª–æ–≤–µ–∫)": 2,
  "–£–ø—Ä–∞–≤–ª—è–ª(–∞) —Å—Ä–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥–æ–π (6-15 —á–µ–ª–æ–≤–µ–∫)": 4,
  "–£–ø—Ä–∞–≤–ª—è–ª(–∞) –±–æ–ª—å—à–æ–π –∫–æ–º–∞–Ω–¥–æ–π (16+ —á–µ–ª–æ–≤–µ–∫)": 5,
  "–£–ø—Ä–∞–≤–ª—è–ª(–∞) —É–¥–∞–ª—ë–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π": 4,
  "–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É–ø—Ä–∞–≤–ª—è–ª(–∞) –∫–æ–º–∞–Ω–¥–æ–π": 1,

  // –û–ø—ã—Ç –ø—Ä–æ–µ–∫—Ç–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  "–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É–ø—Ä–∞–≤–ª—è–ª(–∞) –ø—Ä–æ–µ–∫—Ç–∞–º–∏": 1,
  "–£–ø—Ä–∞–≤–ª—è–ª(–∞) –Ω–µ–±–æ–ª—å—à–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ (–¥–æ 3 –º–µ—Å—è—Ü–µ–≤)": 2,
  "–£–ø—Ä–∞–≤–ª—è–ª(–∞) –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (3-12 –º–µ—Å—è—Ü–µ–≤)": 3,
  "–£–ø—Ä–∞–≤–ª—è–ª(–∞) —Å–ª–æ–∂–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ (12+ –º–µ—Å—è—Ü–µ–≤)": 5,

  // –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á
  "–ë–µ–∑ —Å–∏—Å—Ç–µ–º—ã": 1,
  "–ò—Å–ø–æ–ª—å–∑—É—é –ø—Ä–æ—Å—Ç—ã–µ —Å–ø–∏—Å–∫–∏": 2,
  "–ò—Å–ø–æ–ª—å–∑—É—é —Ç–∞—Å–∫-–º–µ–Ω–µ–¥–∂–µ—Ä—ã": 3,
  "–ò—Å–ø–æ–ª—å–∑—É—é —Å–ª–æ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è": 4,
  "–î–µ–ª–µ–≥–∏—Ä—É—é –∑–∞–¥–∞—á–∏ –∫–æ–º–∞–Ω–¥–µ": 5,

  // –£—Ä–æ–≤–µ–Ω—å —É—á–∞—Å—Ç–∏—è –≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
  "–ù–µ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª(–∞)": 1,
  "–£—á–∞—Å—Ç–≤–æ–≤–∞–ª(–∞) –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏—è—Ö": 3,
  "–£—á–∞—Å—Ç–≤–æ–≤–∞–ª(–∞) –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —á–∞—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏": 3,
  "–£—á–∞—Å—Ç–≤–æ–≤–∞–ª(–∞) –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –æ–±—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏": 4,
  "–£—á–∞—Å—Ç–≤–æ–≤–∞–ª(–∞) –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏": 5,
// –í–æ–ø—Ä–æ—Å 18
"–ù–µ—Ç": 1,
"–î–∞": 5,
// –í–æ–ø—Ä–æ—Å 19
"–õ–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Å—å –∏ –Ω–∞—Ö–æ–∂—É —Ä–µ—à–µ–Ω–∏—è": 5,
"–°—Ç–∞—Ä–∞—é—Å—å —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ, –Ω–æ –∏—Å–ø—ã—Ç—ã–≤–∞—é –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ": 4,
"–û–±—Ä–∞—â–∞—é—Å—å –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫ –∫–æ–ª–ª–µ–≥–∞–º –∏–ª–∏ –¥—Ä—É–∑—å—è–º": 3,
"–ß—É–≤—Å—Ç–≤—É—é —Å–∏–ª—å–Ω—ã–π —Å—Ç—Ä–µ—Å—Å, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å": 2,
"–¢–µ—Ä—è—é –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –Ω–µ –º–æ–≥—É —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è": 1,
// –í–æ–ø—Ä–æ—Å 21
"–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É–ø—Ä–∞–≤–ª—è–ª(–∞) –∫–æ–º–∞–Ω–¥–æ–π": 1,
"–£–ø—Ä–∞–≤–ª—è–ª(–∞) –Ω–µ–±–æ–ª—å—à–æ–π –∫–æ–º–∞–Ω–¥–æ–π (–¥–æ 5 —á–µ–ª–æ–≤–µ–∫)": 2,
"–£–ø—Ä–∞–≤–ª—è–ª(–∞) —Å—Ä–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥–æ–π (6-15 —á–µ–ª–æ–≤–µ–∫)": 4,
"–£–ø—Ä–∞–≤–ª—è–ª(–∞) –±–æ–ª—å—à–æ–π –∫–æ–º–∞–Ω–¥–æ–π (16+ —á–µ–ª–æ–≤–µ–∫)": 5,
"–£–ø—Ä–∞–≤–ª—è–ª(–∞) —É–¥–∞–ª—ë–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π": 4,
// –í–æ–ø—Ä–æ—Å 22
"Beginner (A1)": 1,
"Elementary (A2)": 2,
"Pre-Intermediate (B1)": 2,
"Intermediate (B1)": 3,
"Upper Intermediate (B2)": 4,
"Advanced (C1)": 5,
"Proficiency (C2)": 5,
// –í–æ–ø—Ä–æ—Å 24
"–°–æ–≤—Å–µ–º –Ω–µ —É–º–µ—é": 1,
"–ò—Å–ø–æ–ª—å–∑—É—é —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏": 2,
"–£–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã –∏ –≥—Ä—É–ø–ø—ã": 3,
"–£–º–µ—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏": 4,
"–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏": 5,
// –í–æ–ø—Ä–æ—Å 28
"–ù–µ –∏—Å–ø–æ–ª—å–∑—É—é": 1,
"–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤": 2,
"–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã": 3,
"–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É—é –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –º–µ–∂–¥—É —Å–æ–±–æ–π": 4,
"–°—Ç—Ä–æ—é –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ –≤—Å—é —Ü–∏—Ñ—Ä–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–º–ø–∞–Ω–∏–∏": 5,
  // –ö–µ–π—Å: –∑–∞–ø—É—Å–∫ —Ñ—Ä–∞–Ω—à–∏–∑—ã (–µ—Å–ª–∏ –µ—Å—Ç—å —à–∫–∞–ª–∏—Ä—É–µ–º—ã–µ –æ—Ç–≤–µ—Ç—ã)
  // ...–¥–æ–±–∞–≤–ª—è–π –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –µ—Å–ª–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è.

  // –û—Ü–µ–Ω–∫–∞ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
  "–°–æ–≤—Å–µ–º –Ω–µ –∫—Ä–µ–∞—Ç–∏–≤–µ–Ω": 1,
  "–†–µ–¥–∫–æ –ø—Ä–æ—è–≤–ª—è—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 2,
  "–ò–Ω–æ–≥–¥–∞ –ø—Ä–æ—è–≤–ª—è—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 3,
  "–ß–∞—Å—Ç–æ –ø—Ä–æ—è–≤–ª—è—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 4,
  "–ü–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–æ—è–≤–ª—è—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 5,

  // –ù–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
  "–£–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã –∏ –≥—Ä—É–ø–ø—ã": 3,
  "–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á": 2,
  "–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç—ã": 3,
  "–£–º–µ—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ workflows": 4,
  "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è": 5,
  "–ò—Å–ø–æ–ª—å–∑—É—é —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏": 1,
  "–£–º–µ—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏": 4,
  "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏": 5,
  "–ù–µ –∏—Å–ø–æ–ª—å–∑—É—é": 1,
  "–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤": 2,
  "–ò—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã": 3,
  "–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É—é –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –º–µ–∂–¥—É —Å–æ–±–æ–π": 4,
  "–°—Ç—Ä–æ—é –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ –≤—Å—é —Ü–∏—Ñ—Ä–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–º–ø–∞–Ω–∏–∏": 5,
  "–£–º–µ—é —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–æ—Å—Ç—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏": 2,
  "–£–º–µ—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—ã –∏ —Å–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã": 3,
  "–£–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã": 4,
  "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞": 5,
  "–ò—Å–ø–æ–ª—å–∑—É—é –≥–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã": 2,
  "–°–æ–∑–¥–∞—é –ø—Ä–æ—Å—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏": 3,
  "–°–æ–∑–¥–∞—é —Å–ª–æ–∂–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–π": 4,
  "–†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—é –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤": 5,
  "–ü–æ–ª–∞–≥–∞—é—Å—å –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥—Ä—É–≥–∏—Ö": 2,
  "–ú–æ–≥—É –≤—ã–±—Ä–∞—Ç—å –∏–∑ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –º–Ω–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤": 3,
  "–ü—Ä–æ–≤–æ–∂—É —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–æ–º": 4,
  "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –ø–æ–¥–±–∏—Ä–∞—é –∏ –≤–Ω–µ–¥—Ä—è—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã": 5,

  // –î–ª—è –¥—Ä—É–≥–∏—Ö —Ä–µ–¥–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:
  "–û–±—Ä–∞—â–∞—é—Å—å –∑–∞ —Å–æ–≤–µ—Ç–æ–º –∫ —ç–∫—Å–ø–µ—Ä—Ç–∞–º": 3,
  "–ò—Å–ø–æ–ª—å–∑—É—é —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤": 2,
  "–ü—Ä–æ–≤–æ–∂—É –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –±–µ—Å–µ–¥—ã —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞": 4,
  "–ò–Ω–æ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è –¥–æ—Å—Ç–∏—á—å —Å–æ–≥–ª–∞—à–µ–Ω–∏—è": 3,
  "–£–º–µ—é –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º": 3,
  "–°–æ–∑–¥–∞—é –ø—Ä–æ—Å—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏": 3,

  // –î–ª—è –∫–µ–π—Å–∞/–æ—Ç–∫—Ä—ã—Ç—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Äî –µ—Å–ª–∏ –µ—Å—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Äî –¥–æ–±–∞–≤–∏—Ç—å.
    };

    // –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º (31 –≤–æ–ø—Ä–æ—Å)
    const weights = [8,7,6,7,5,8,7,6,5,6,5,8,7,6,7,5,4,5,5,4,7,5,6,5,7,8,7,6,7,6,8];

    let persons = [];
    let header = [];
    let answers = [];

    document.getElementById('fileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) handleFile(file);
    });

    document.getElementById('fioSelect').addEventListener('change', function() {
      displayPerson(this.value);
    });

    // –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –ø–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–∞
    function handleFile(file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        let data, workbook, sheet, json;
        if (file.name.endsWith('.csv')) {
          data = e.target.result;
          json = XLSX.utils.sheet_to_json(XLSX.read(data, {type: 'string'}).Sheets.Sheet1, {header: 1});
        } else {
          data = new Uint8Array(e.target.result);
          workbook = XLSX.read(data, { type: 'array' });
          sheet = workbook.Sheets[workbook.SheetNames[0]];
          json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
        }
        processData(json);
      };
      if (file.name.endsWith('.csv')) reader.readAsText(file);
      else reader.readAsArrayBuffer(file);
    }

    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    function processData(data) {
      persons = [];
      header = data[0];
      answers = [];
      let fioCol = header.findIndex(col => col && col.toLowerCase().includes('—Ñ–∏–æ'));
      if (fioCol === -1) fioCol = header.findIndex(col => col && (col.toLowerCase().includes('—Ñ–∞–º–∏–ª–∏—è') || col.toLowerCase().includes('–∏–º—è')));
      if (fioCol === -1) fioCol = 1; // fallback

      // –û–ø—Ä–µ–¥–µ–ª–∏–º —Å—Ç–æ–ª–±—Ü—ã —Å –æ—Ç–≤–µ—Ç–∞–º–∏
      let answerStart = fioCol + 1;
      // –æ—Ç—Ä–µ–∂–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –ø—É—Å—Ç—ã–º –§–ò–û
      data.slice(1).forEach(row => {
        if (row[fioCol] && row[fioCol].toString().trim().length > 0) {
          persons.push(row[fioCol].toString().trim());
          answers.push(row.slice(answerStart, answerStart + 31));
        }
      });
      // –ó–∞–ø–æ–ª–Ω—è–µ–º select
      let fioSelect = document.getElementById('fioSelect');
      fioSelect.innerHTML = '';
      persons.forEach((fio, i) => {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = fio;
        fioSelect.appendChild(opt);
      });
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–≤–æ–≥–æ —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞
      displayPerson(0);
      // –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
      displaySummary();
    }

    // –í—ã–≤–æ–¥ —Ä–∞–∑–±–∞–ª–æ–≤–∫–∏ –ø–æ –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    function displayPerson(idx) {
      if (!answers[idx]) return;
      const ans = answers[idx];
      let details = `<h3 class="centered">${persons[idx]}</h3>`;
      details += `<table><tr><th>–í–æ–ø—Ä–æ—Å</th><th>–û—Ç–≤–µ—Ç</th><th>–ë–∞–ª–ª</th></tr>`;
      let softScore = 0, hardScore = 0, softMax = 0, hardMax = 0;
      for (let i = 0; i < ans.length; i++) {
        let a = (ans[i] || '').toString().trim();
        let val = (a in likertMapping) ? likertMapping[a] : 0;
        const weight = weights[i];
        let className = '';
        if (!(a in likertMapping)) className = 'warning';
        if (i < 22) {
          softScore += val * weight;
          softMax += 5 * weight;
        } else {
          hardScore += val * weight;
          hardMax += 5 * weight;
        }
        details += `<tr class="${className}"><td>–í–æ–ø—Ä–æ—Å ${i+1}</td><td>${a}</td><td>${val}${className ? ' (–Ω–µ—Ç —Ä–∞–∑–±–∞–ª–æ–≤–∫–∏!)' : ''}</td></tr>`;
      }
      details += '</table>';
      document.getElementById('details').innerHTML = details;
      showPersonResult(softScore, hardScore, softMax, hardMax);
    }

    // –ë–ª–æ–∫ –∏—Ç–æ–≥–æ–≤—ã—Ö –±–∞–ª–ª–æ–≤ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—É
    function showPersonResult(softScore, hardScore, softMax, hardMax) {
      const softPct = Math.round((softScore / softMax) * 100);
      const hardPct = Math.round((hardScore / hardMax) * 100);
      const total = Math.round(softPct * 0.6 + hardPct * 0.4);
      let level = `<span class="level low">üî¥ –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å</span>`;
      if (total >= 85) level = `<span class="level high">üü¢ –û—Ç–ª–∏—á–Ω–æ ‚Äì –∑—Ä–µ–ª—ã–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏</span>`;
      else if (total >= 65) level = `<span class="level good">üü° –•–æ—Ä–æ—à–æ ‚Äì –µ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª</span>`;
      else if (total >= 45) level = `<span class="level medium">üü† –°—Ä–µ–¥–Ω–µ ‚Äì —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑–≤–∏—Ç–∏–µ</span>`;
      document.getElementById('personResult').innerHTML = `
        <div class="result-block centered">
          <div>Soft skills: <span class="score">${softPct}%</span></div>
          <div>Hard skills: <span class="score">${hardPct}%</span></div>
          <div>–û–±—â–∏–π –±–∞–ª–ª: <span class="score">${total}%</span></div>
          <div>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è: ${level}</div>
        </div>
      `;
    }

    // –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –≤—Å–µ–º
    function displaySummary() {
      let out = '<h3>–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –≤—Å–µ–º —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞–º</h3>';
      out += `<table><tr><th>–§–ò–û</th><th>Soft %</th><th>Hard %</th><th>Total %</th><th>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</th></tr>`;
      answers.forEach((ans, idx) => {
        let softScore = 0, hardScore = 0, softMax = 0, hardMax = 0;
        for (let i = 0; i < ans.length; i++) {
          let a = (ans[i] || '').toString().trim();
          let val = (a in likertMapping) ? likertMapping[a] : 0;
          const weight = weights[i];
          if (i < 22) {
            softScore += val * weight;
            softMax += 5 * weight;
          } else {
            hardScore += val * weight;
            hardMax += 5 * weight;
          }
        }
        const softPct = Math.round((softScore / softMax) * 100);
        const hardPct = Math.round((hardScore / hardMax) * 100);
        const total = Math.round(softPct * 0.6 + hardPct * 0.4);
        let level = `üî¥ –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å`;
        if (total >= 85) level = `üü¢ –û—Ç–ª–∏—á–Ω–æ ‚Äì –∑—Ä–µ–ª—ã–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏`;
        else if (total >= 65) level = `üü° –•–æ—Ä–æ—à–æ ‚Äì –µ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª`;
        else if (total >= 45) level = `üü† –°—Ä–µ–¥–Ω–µ ‚Äì —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑–≤–∏—Ç–∏–µ`;
        out += `<tr><td>${persons[idx]}</td><td>${softPct}</td><td>${hardPct}</td><td>${total}</td><td>${level}</td></tr>`;
      });
      out += '</table>';
      document.getElementById('summary').innerHTML = out;
    }
  </script>
</body>
</html>
