<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–¢–µ—Å—Ç –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π TWIN</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; background: #f9f9f9; }
    h1 { text-align: center; }
    input[type=file] { margin-bottom: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; }
    th { background: #eee; }
  </style>
</head>
<body>
<h1>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π</h1>
<input type="file" id="file" accept=".xlsx">
<div id="output"></div>

<script>
const weights = [8,7,6,7,5,8,7,6,5,6,5,8,7,6,7,5,4,5,5,4,7,5,6,5,7,8,7,6,7,6,8];

const mapping = {
  '–°–æ–≤—Å–µ–º –Ω–µ —É–≤–µ—Ä–µ–Ω': 1, '–°–∫–æ—Ä–µ–µ –Ω–µ —É–≤–µ—Ä–µ–Ω': 2, '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ': 3, '–°–∫–æ—Ä–µ–µ —É–≤–µ—Ä–µ–Ω': 4, '–ü–æ–ª–Ω–æ—Å—Ç—å—é —É–≤–µ—Ä–µ–Ω': 5,
  '–î–µ–º–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∏–π': 4, '–î–∏—Ä–µ–∫—Ç–∏–≤–Ω—ã–π': 2, '–°–∏—Ç—É–∞—Ç–∏–≤–Ω—ã–π': 5, '–õ–∏–±–µ—Ä–∞–ª—å–Ω—ã–π': 3, '–°–º–µ—à–∞–Ω–Ω—ã–π': 4,
  '–ü—Ä–æ–≤–æ–∂—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å': 5,
  '–ù–∞—Å—Ç–∞–∏–≤–∞—é –Ω–∞ —Å–≤–æ—ë–º —Ä–µ—à–µ–Ω–∏–∏, —Ç–∞–∫ –∫–∞–∫ —É–≤–µ—Ä–µ–Ω –≤ –µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏': 2,
  '–ü–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—é —Ä–µ—à–µ–Ω–∏–µ —Å —É—á—ë—Ç–æ–º –º–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã': 4,
  '–î–µ–ª–µ–≥–∏—Ä—É—é –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–µ': 3,
  '–ò–≥–Ω–æ—Ä–∏—Ä—É—é –Ω–µ—Å–æ–≥–ª–∞—Å–∏–µ, —Ç–∞–∫ –∫–∞–∫ —Å—á–∏—Ç–∞—é –µ–≥–æ –Ω–µ–æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–º': 1,
  '–ü–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞': 1, '–†–µ–¥–∫–æ': 2, '–ò–Ω–æ–≥–¥–∞': 3, '–ß–∞—Å—Ç–æ': 4, '–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞': 5,
  '–õ–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Å—å –∏ –Ω–∞—Ö–æ–∂—É –±–∞–ª–∞–Ω—Å': 5, '–°—Ç–∞—Ä–∞—é—Å—å —Ä–∞–∑–¥–µ–ª—è—Ç—å –ª–∏—á–Ω—É—é –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –∂–∏–∑–Ω—å': 4,
  '–û–±—Ä–∞—â–∞—é—Å—å –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫ –∫–æ–ª–ª–µ–≥–∞–º –∏–ª–∏ –¥—Ä—É–∑—å—è–º': 3, '–ß—É–≤—Å—Ç–≤—É—é —Å—Ç—Ä–µ—Å—Å, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å': 2,
  '–¢–µ—Ä—è—é –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –Ω–µ –º–æ–≥—É —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏': 1,
  '–°–æ–≤—Å–µ–º –Ω–µ —É–º–µ—é': 1, '–†–µ–¥–∫–æ —É–¥–∞—ë—Ç—Å—è': 2, '–ò–Ω–æ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è': 3, '–ß–∞—Å—Ç–æ —É–¥–∞—ë—Ç—Å—è': 4, '–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è': 5,
  '–°—Ç–∞—Ä–∞—é—Å—å –±—ã—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã–º –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º': 5,
  '–ò—Å–ø–æ–ª—å–∑—É—é —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤': 3,
  '–ê–¥–∞–ø—Ç–∏—Ä—É—é —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏': 4,
  '–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –ø–∏—Å—å–º–µ–Ω–Ω—É—é –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é –¥–ª—è —á—ë—Ç–∫–æ—Å—Ç–∏': 2,
  '–ò–∑–±–µ–≥–∞—é –ª–∏—à–Ω–µ–≥–æ –æ–±—â–µ–Ω–∏—è, —Å–æ—Å—Ä–µ–¥–æ—Ç–∞—á–∏–≤–∞—è—Å—å –Ω–∞ –∑–∞–¥–∞—á–∞—Ö': 1,
  '–ü—Ä–æ–≤–æ–∂—É –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –±–µ—Å–µ–¥—ã —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞': 4,
  '–û—Ä–≥–∞–Ω–∏–∑—É—é –∫–æ–º–∞–Ω–¥–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ—à–µ–Ω–∏—è': 5,
  '–ü–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é –∑–∞–¥–∞—á–∏, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ': 3,
  '–ò–≥–Ω–æ—Ä–∏—Ä—É—é –∫–æ–Ω—Ñ–ª–∏–∫—Ç, –Ω–∞–¥–µ—è—Å—å, —á—Ç–æ –æ–Ω —Ä–∞–∑—Ä–µ—à–∏—Ç—Å—è —Å–∞–º': 2,
  '–£–≤–æ–ª—å–Ω—è—é —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –º–æ–≥—É—Ç –¥–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è': 1,
  '–†–µ–¥–∫–æ –ø—Ä–æ—è–≤–ª—è—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å': 2, '–ò–Ω–æ–≥–¥–∞ –ø—Ä–æ—è–≤–ª—è—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å': 3,
  '–ß–∞—Å—Ç–æ –ø—Ä–æ—è–≤–ª—è—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å': 4, '–ü–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–æ—è–≤–ª—è—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å': 5,
  '–ù–µ—Ç': 1, '–î–∞': 5,
  'Beginner (A1)': 1, 'Elementary (A2)': 2, 'Pre-Intermediate (B1)': 3,
  'Upper Intermediate (B2)': 4, 'Advanced (C1)': 5, 'Proficiency (C2)': 5,
  '–ù–µ –∏—Å–ø–æ–ª—å–∑—É—é': 1, '–ò—Å–ø–æ–ª—å–∑—É—é —Ä–µ–¥–∫–æ': 2, '–ò—Å–ø–æ–ª—å–∑—É—é —á–∞—Å—Ç–∏—á–Ω–æ': 3, '–ò—Å–ø–æ–ª—å–∑—É—é —Ä–µ–≥—É–ª—è—Ä–Ω–æ': 4,
  '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é': 5, '–ü–æ—Å—Ç–æ—è–Ω–Ω–æ': 5
};

function calculateScores(data) {
  let html = '<table><tr><th>–§–ò–û</th><th>Soft %</th><th>Hard %</th><th>Total %</th><th>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</th></tr>';
  data.slice(1).forEach(row => {
    const name = row[1];
    let softScore = 0, hardScore = 0, softMax = 0, hardMax = 0;
    for (let i = 0; i < 31; i++) {
      const val = mapping[row[i + 2]?.trim()] || 0;
      const weight = weights[i];
      if (i < 22) {
        softScore += val * weight;
        softMax += 5 * weight;
      } else {
        hardScore += val * weight;
        hardMax += 5 * weight;
      }
    }
    const softPct = Math.round(softScore / softMax * 100);
    const hardPct = Math.round(hardScore / hardMax * 100);
    const total = Math.round(softPct * 0.6 + hardPct * 0.4);
    let interp = 'üî¥ –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å ‚Äì –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞';
    if (total >= 85) interp = 'üü¢ –û—Ç–ª–∏—á–Ω–æ ‚Äì –∑—Ä–µ–ª—ã–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏';
    else if (total >= 65) interp = 'üü° –•–æ—Ä–æ—à–æ ‚Äì –µ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª';
    else if (total >= 45) interp = 'üü† –°—Ä–µ–¥–Ω–µ ‚Äì —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑–≤–∏—Ç–∏–µ';
    html += `<tr><td>${name}</td><td>${softPct}</td><td>${hardPct}</td><td>${total}</td><td>${interp}</td></tr>`;
  });
  html += '</table>';
  document.getElementById('output').innerHTML = html;
}

document.getElementById('file').addEventListener('change', function(e) {
  const reader = new FileReader();
  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, {type: 'array'});
    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
    const parsed = XLSX.utils.sheet_to_json(firstSheet, {header: 1});
    calculateScores(parsed);
  };
  reader.readAsArrayBuffer(this.files[0]);
});
</script>
</body>
</html>
